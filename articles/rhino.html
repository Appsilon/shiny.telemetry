<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Setup shiny.telemetry in a Rhino application • shiny.telemetry</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Setup shiny.telemetry in a Rhino application">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-D33PHDKY5M"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-D33PHDKY5M');
</script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-FQQZL5V93G"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-FQQZL5V93G');
</script><script async defer src="https://buttons.github.io/buttons.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">shiny.telemetry</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1.9002</small>

    <a href="https://www.appsilon.com/rhinoverse" class="external-link home"><i class="fa fa-lg fa-chevron-left"></i></a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-how-to-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book-reader"></span> How-to Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-how-to-guides">
<li><a class="dropdown-item" href="../articles/rhino.html">Setup shiny.telemetry in a Rhino application</a></li>
    <li><a class="dropdown-item" href="../articles/tracking-specific-input-id.html">Track a Subset of Inputs to Improve Performance</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Data Storage backends</h6></li>
    <li><a class="dropdown-item" href="../articles/databases.html">Use External Databases with shiny.telemetry</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Appsilon/shiny.telemetry"><span class="fa fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/Appsilon"><span class="fa fa-twitter fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://fosstodon.org/@appsilon"><span class="fa fab fa-mastodon fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Setup shiny.telemetry in a Rhino application</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Appsilon/shiny.telemetry/blob/main/vignettes/rhino.Rmd" class="external-link"><code>vignettes/rhino.Rmd</code></a></small>
      <div class="d-none name"><code>rhino.Rmd</code></div>
    </div>

    
    
<p>The <a href="https://appsilon.github.io/shiny.telemetry/">shiny.telemetry</a> package can be used with any Shiny
application and in this guide we will show how to add it to a <a href="https://appsilon.github.io/rhino/" class="external-link">{rhino} application</a>.</p>
<div style="float: right;">
<p><a href="https://appsilon.github.io/rhino/" target="_blank" class="external-link"><img src="https://appsilon.github.io/rhino/reference/figures/rhino.png" style="height: 140px;"></a>
<a href="https://appsilon.github.io/shiny.telemetry/"><img src="https://appsilon.github.io/shiny.telemetry/reference/figures/shiny-telemetry.png" style="height: 140px;"></a></p>
</div>
<p><a href="https://appsilon.github.io/rhino/" class="external-link">rhino</a> is a package that provides a framework to build
high quality, enterprise-grade Shiny apps at speed. It is designed to
help you build Shiny apps that are scalable, maintainable, and
robust.</p>
<p>Using <code>{shiny.telemtry}</code> with <a href="https://appsilon.github.io/rhino/" class="external-link">rhino</a> is very
simple and it requires only a few lines of code just as any other
app.</p>
<p>Useful links:</p>
<ul>
<li><a href="https://appsilon.github.io/rhino/articles/tutorial/create-your-first-rhino-app.html" class="external-link">Creating
your first Rhino app</a></li>
<li><a href="https://appsilon.github.io/rhino/articles/explanation/application-structure.html" class="external-link">App
structure in a Rhino application</a></li>
<li><a href="https://appsilon.github.io/rhino/articles/how-to/write-r-code.html" class="external-link">Write
R code in Rhino</a></li>
<li><a href="https://appsilon.github.io/shiny.telemetry/articles/databases.html">Use
External Databases with <code>{shiny.telemetry}</code></a></li>
</ul>
<div class="section level2">
<h2 id="creating-a-new-rhino-application">Creating a new <code>{rhino}</code> application<a class="anchor" aria-label="anchor" href="#creating-a-new-rhino-application"></a>
</h2>
<p>Starting a new <a href="https://appsilon.github.io/rhino/" class="external-link">rhino</a> application is as simple as
running the <code>rhino::init()</code> command. Learn more about
“Creating your first Rhino app” <a href="https://appsilon.github.io/rhino/articles/tutorial/create-your-first-rhino-app.html" class="external-link">in
this guide</a>.</p>
<p>The command creates a boilerplate folder structure for a
<a href="https://appsilon.github.io/rhino/" class="external-link">rhino</a> application, where <code>app/main.R</code> contains
the UI and server logic. The application structure is best explained on
this <a href="https://appsilon.github.io/rhino/articles/explanation/application-structure.html" class="external-link">“App
structure” documentation</a>.</p>
<p>Before setting up <a href="https://appsilon.github.io/shiny.telemetry/">shiny.telemetry</a> in the application,
let’s add a simple input element to the boilerplate code. Otherwise, the
only events that will be tracked are the login, logout and the user’s
browser version.</p>
<p>For this we will add a text input to the application and in the
sections below observe how it is being tracked by
<code>{shiny.telemtry}</code>.</p>
<p>Adding the code below to the <code>app/main.R</code> file will add a
text input and a “Hello world” message with the contents of the
input.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># app/main.R (replace with the following code)</span></span>
<span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span></span>
<span>  <span class="va">shiny</span><span class="op">[</span></span>
<span>    <span class="va">bootstrapPage</span>, <span class="va">div</span>, <span class="va">moduleServer</span>, <span class="va">NS</span>, <span class="va">renderUI</span>, <span class="va">tags</span>, <span class="va">textInput</span>, <span class="va">uiOutput</span>, </span>
<span>    <span class="va">verbatimTextOutput</span>,</span>
<span>  <span class="op">]</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/NS.html" class="external-link">NS</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/bootstrapPage.html" class="external-link">bootstrapPage</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textInput.html" class="external-link">textInput</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"name"</span><span class="op">)</span>, <span class="st">"My name"</span>, <span class="st">"world"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">verbatimTextOutput</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"text"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html" class="external-link">uiOutput</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"message"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/moduleServer.html" class="external-link">moduleServer</a></span><span class="op">(</span><span class="va">id</span>, <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">output</span><span class="op">$</span><span class="va">message</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html" class="external-link">renderUI</a></span><span class="op">(</span><span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">div</a></span><span class="op">(</span></span>
<span>        style <span class="op">=</span> <span class="st">"display: flex; justify-content: center; align-items: center; height: 50vh;"</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">h1</span><span class="op">(</span></span>
<span>          <span class="va">tags</span><span class="op">$</span><span class="fu">span</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Hello %s! "</span>, <span class="va">input</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          <span class="va">tags</span><span class="op">$</span><span class="fu">a</span><span class="op">(</span><span class="st">"Check out Rhino docs!"</span>, href <span class="op">=</span> <span class="st">"https://appsilon.github.io/rhino/"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level3">
<h3 id="using-an-existing-rhino-application">Using an existing <code>{rhino}</code> application<a class="anchor" aria-label="anchor" href="#using-an-existing-rhino-application"></a>
</h3>
<p>Alternatively, you can add <a href="https://appsilon.github.io/shiny.telemetry/">shiny.telemetry</a> to an
existing <a href="https://appsilon.github.io/rhino/" class="external-link">rhino</a> application by following the steps in the
next sections.</p>
<p>Please note, that if there are no input elements in the application,
the only events that will be tracked are the login, logout and the
user’s browser version.</p>
</div>
</div>
<div class="section level2">
<h2 id="setup-shiny-telemetry">Setup <code>{shiny.telemetry}</code><a class="anchor" aria-label="anchor" href="#setup-shiny-telemetry"></a>
</h2>
<p>The following 4 steps are needed to start using
<a href="https://appsilon.github.io/shiny.telemetry/">shiny.telemetry</a> for tracking inputs in the
application:</p>
<ol style="list-style-type: decimal">
<li>Import functions from <a href="https://appsilon.github.io/shiny.telemetry/">shiny.telemetry</a> using
<a href="https://klmr.me/box/" class="external-link">box</a>;</li>
<li>Add Javascript code to UI definition;</li>
<li>Create a <code>Telemetry</code> object;</li>
<li>Start telemetry session attached to a Shiny session.</li>
</ol>
<p>The first step is to install <a href="https://appsilon.github.io/shiny.telemetry/">shiny.telemetry</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rhino</span><span class="fu">::</span><span class="fu">pkg_install</span><span class="op">(</span><span class="st">"shiny.telemetry"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="import-functions-from-shiny-telemetry">Import functions from <code>shiny.telemetry</code><a class="anchor" aria-label="anchor" href="#import-functions-from-shiny-telemetry"></a>
</h3>
<p>The <a href="https://appsilon.github.io/rhino/" class="external-link">rhino</a> frameworks promotes the use of
<a href="https://klmr.me/box/" class="external-link">box</a> to import functions from packages and internal
modules. See the <a href="https://appsilon.github.io/rhino/" class="external-link">rhino</a> documentation on how to <a href="https://appsilon.github.io/rhino/articles/how-to/write-r-code.html" class="external-link">write
R code</a> for more details.</p>
<p>The minimal setup for <a href="https://appsilon.github.io/shiny.telemetry/">shiny.telemetry</a> needs to
import:</p>
<ul>
<li>Class for the chosen <code>DataStorage</code> backend
(e.g. <code>DataStorageLogFile</code> for a text-based storage,
<code>DataStorageMariaDB</code> for a MariaDB database, among
others);</li>
<li>Class for the Telemetry function that will track all the
events;</li>
<li>Function to load the necessary Javascript code in the UI
definition.</li>
</ul>
<p>Any additional function that is being used, needs to be imported as
well. This can be done by adding the following code to the top of
<code>app/main.R</code> file on the package imports:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># app/main.R (top of file)</span></span>
<span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span></span>
<span>  <span class="va">shiny</span><span class="op">[</span></span>
<span>    <span class="va">bootstrapPage</span>, <span class="va">div</span>, <span class="va">moduleServer</span>, <span class="va">NS</span>, <span class="va">renderUI</span>, <span class="va">tags</span>, <span class="va">textInput</span>, <span class="va">uiOutput</span>,</span>
<span>    <span class="va">verbatimTextOutput</span>,</span>
<span>  <span class="op">]</span>,</span>
<span>  <span class="co"># other packaage imports ...</span></span>
<span>  <span class="va">shiny.telemetry</span><span class="op">[</span><span class="va">DataStorageLogFile</span>, <span class="va">Telemetry</span>, <span class="va">use_telemetry</span><span class="op">]</span>,</span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="add-javascript-code-to-ui-definition">Add Javascript code to UI definition<a class="anchor" aria-label="anchor" href="#add-javascript-code-to-ui-definition"></a>
</h3>
<p>The next step is to call <code><a href="../reference/use_telemetry.html">use_telemetry()</a></code> function in the
root UI definition on <code>app/main.R</code> file to load the necessary
Javascript code.</p>
<p>Note that the <code>id</code> parameter needs to be passed to the
<code><a href="../reference/use_telemetry.html">use_telemetry()</a></code> function to ensure that the browser version
is tracked correctly, as well as the mechanism to track anonymous user
via client side cookies.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># app/main.R (change n `ui` function)</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/NS.html" class="external-link">NS</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/bootstrapPage.html" class="external-link">bootstrapPage</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/use_telemetry.html">use_telemetry</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,</span>
<span>    <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span></span>
<span>      style <span class="op">=</span> <span class="st">"display: flex; justify-content: center; align-items: center; margin-top: 2em;"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textInput.html" class="external-link">textInput</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"name"</span><span class="op">)</span>, <span class="st">"My name"</span>, <span class="st">"world"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">verbatimTextOutput</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"text"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html" class="external-link">uiOutput</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"message"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="create-telemetry-object">Create <code>Telemetry</code> object<a class="anchor" aria-label="anchor" href="#create-telemetry-object"></a>
</h3>
<p>The next step is to create a <code>Telemetry</code> object that will
be used to track events in the app.</p>
<p>We recommend creating an instance of <code>Telemetry</code> on the
<code>app/main.R</code> and then start the telemetry session on the root
<code>server</code> function definition, just as shown in the code
below.</p>
<p>This will create a text file with the events tracked by
<a href="https://appsilon.github.io/shiny.telemetry/">shiny.telemetry</a>. It is the simplest storage backend
available and the file contains JSON data that can be easily read and
processed.</p>
<p>To learn about other backends see the <a href="https://appsilon.github.io/shiny.telemetry/articles/databases.html">“Use
External Databases with shiny.telemetry” guide</a>.</p>
<p>Please note, that the values themselves are not tracked by default
and need to be enabled by setting the <code>track_values</code>
parameter to <code>TRUE</code> in the <a href="https://appsilon.github.io/shiny.telemetry/reference/Telemetry.html#method-Telemetry-start_session"><code>start_session()</code></a>
method. In this example we are enabling them to help demonstrate the
capabilities of <a href="https://appsilon.github.io/shiny.telemetry/">shiny.telemetry</a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># app/main.R (create telemetry object and initialize in a session)</span></span>
<span><span class="va">telemetry</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Telemetry.html">Telemetry</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  app_name <span class="op">=</span> <span class="st">"rhino_app"</span>,</span>
<span>  data_storage <span class="op">=</span> <span class="va"><a href="../reference/DataStorageLogFile.html">DataStorageLogFile</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"local_file.txt"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/moduleServer.html" class="external-link">moduleServer</a></span><span class="op">(</span><span class="va">id</span>, <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">telemetry</span><span class="op">$</span><span class="fu">start_session</span><span class="op">(</span>track_values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="co"># Server logic ...</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The <a href="https://appsilon.github.io/shiny.telemetry/reference/Telemetry.html#method-Telemetry-start_session"><code>telemetry$start_session()</code></a>
call can be customized to enable/disable different types of events and
can be further extended to include/exclude input ids. See the <a href="https://appsilon.github.io/shiny.telemetry/articles/tracking-specific-input-id.html">Guide
on tracking specific inputs</a> for more details.</p>
<p>The application is now ready to track the input changes, login,
logout and browser version. Start the application and test it out
yourself.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html" class="external-link">runApp</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Start the application and change inputs </span></span></code></pre></div>
<div class="float">
<img src="figures/rhino_app_example.gif" alt="Figure 1: Running Rhino app and changing the input."><div class="figcaption">Figure 1: Running Rhino app and changing the
input.</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="access-the-events">Access the events<a class="anchor" aria-label="anchor" href="#access-the-events"></a>
</h2>
<p>The <a href="https://appsilon.github.io/shiny.telemetry/">shiny.telemetry</a> package provides a default
dashboard to visualize the events tracked by the application. In this
example we will use the <code>local_file.txt</code> that has been
configured in the application.</p>
<p>To start the dashboard run the code below after installing the
suggested packages
(<code>renv::install("semantic.dashboard", "shinyjs", "plotly", "timevis", "DT")</code>)</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Required suggested packages:</span></span>
<span><span class="co">#  renv::install("semantic.dashboard", "shinyjs", "plotly", "timevis", "DT")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://appsilon.github.io/shiny.telemetry/">shiny.telemetry</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_storage</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/DataStorageLogFile.html">DataStorageLogFile</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"local_file.txt"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/analytics_app.html">analytics_app</a></span><span class="op">(</span>data_storage <span class="op">=</span> <span class="va">data_storage</span><span class="op">)</span></span></code></pre></div>
<p>This will start a dashboard that will show the events tracked by the
application. It shows:</p>
<ul>
<li>General stats with the number of events, unique users and average
session;</li>
<li>Activity stats with event data by input id;</li>
<li>User stats with session by same user
<ul>
<li>Returning anonymous users are tracked by client side cookies;</li>
</ul>
</li>
<li>Session stats with duration and activity per user session.</li>
</ul>
<div class="float">
<img src="figures/rhino_dashboard.gif" alt="Figure 2: Dashboard demo."><div class="figcaption">Figure 2: Dashboard demo.</div>
</div>
<p>Other examples for the different backends can be found in the
<code>inst/examples</code> folder of the package.</p>
<div class="section level4">
<h4 id="alternative-methods-to-access-event-data">Alternative methods to access event data<a class="anchor" aria-label="anchor" href="#alternative-methods-to-access-event-data"></a>
</h4>
<p>The event data can be accessed directly, either via the
<code>DataStorage</code> API in <a href="https://appsilon.github.io/shiny.telemetry/">shiny.telemetry</a> or by
accessing the data directly in the backend.</p>
<p>The <code>DataStorage</code> API has 2 main functions to read and
write data to the respective backend.</p>
<ol style="list-style-type: decimal">
<li>
<a href="https://appsilon.github.io/shiny.telemetry/reference/DataStorage.html#method-DataStorage-read_event_data"><code>read_event_data()</code></a>
used to read data from the backend and returns a data frame with the
events data;
<ul>
<li>Optionally parameters can be used to limit the results by data range
and application name;</li>
</ul>
</li>
<li>
<a href="https://appsilon.github.io/shiny.telemetry/reference/DataStorage.html#method-DataStorage-insert"><code>insert</code></a>
used to write new events to the backend.</li>
</ol>
<p>To read all the data being tracked in this example we can run the
following code:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://appsilon.github.io/shiny.telemetry/">shiny.telemetry</a></span><span class="op">)</span></span>
<span><span class="va">data_storage</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/DataStorageLogFile.html">DataStorageLogFile</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"local_file.txt"</span><span class="op">)</span></span>
<span><span class="va">data_storage</span><span class="op">$</span><span class="fu">read_event_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="11%">
<col width="7%">
<col width="11%">
<col width="11%">
<col width="5%">
<col width="17%">
<col width="22%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">app_name</th>
<th align="left">type</th>
<th align="left">session</th>
<th align="left">username</th>
<th align="left">id</th>
<th align="left">value</th>
<th align="left">time</th>
<th align="left">date</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">rhino_app</td>
<td align="left">login</td>
<td align="left">61dd2c…</td>
<td align="left">9be81b…</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">2025-07-14 09:13:35</td>
<td align="left">2025-07-14</td>
</tr>
<tr class="even">
<td align="left">rhino_app</td>
<td align="left">input</td>
<td align="left">61dd2c…</td>
<td align="left">NA</td>
<td align="left">name</td>
<td align="left">John Doe</td>
<td align="left">2025-07-14 09:13:35</td>
<td align="left">2025-07-14</td>
</tr>
<tr class="odd">
<td align="left">rhino_app</td>
<td align="left">input</td>
<td align="left">61dd2c…</td>
<td align="left">NA</td>
<td align="left">name</td>
<td align="left">Jane Doe</td>
<td align="left">2025-07-14 09:13:35</td>
<td align="left">2025-07-14</td>
</tr>
<tr class="even">
<td align="left">rhino_app</td>
<td align="left">input</td>
<td align="left">61dd2c…</td>
<td align="left">NA</td>
<td align="left">name</td>
<td align="left">My custom name</td>
<td align="left">2025-07-14 09:13:35</td>
<td align="left">2025-07-14</td>
</tr>
<tr class="odd">
<td align="left">rhino_app</td>
<td align="left">logout</td>
<td align="left">61dd2c…</td>
<td align="left">9be81b…</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">2025-07-14 09:13:35</td>
<td align="left">2025-07-14</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>To use <a href="https://appsilon.github.io/shiny.telemetry/">shiny.telemetry</a> with rhino, you only need to
make 4 minor adjustments that adds six lines of code <em>(with default
options)</em>. It is as easy as doing it with any other Shiny
application.</p>
<p>The setup allows to access all of <a href="https://appsilon.github.io/shiny.telemetry/">shiny.telemetry</a>
functionality to write events to a data storage backed and it will write
4 types of events:</p>
<ul>
<li>Login timestamp with username <em>(if available)</em>;</li>
<li>Browser user agent;</li>
<li>Logout timestamp when the session ends;</li>
<li>All input changes.</li>
</ul>
<p>To learn how to use Database backends you can refer to the <a href="https://appsilon.github.io/shiny.telemetry/articles/databases.html">“Use
External Databases with shiny.telemetry” guide</a>.</p>
</div>
<div class="section level2">
<h2 id="appendix-use-an-external-database">Appendix: Use an External Database<a class="anchor" aria-label="anchor" href="#appendix-use-an-external-database"></a>
</h2>
<p>The storage backend can be swapped between the JSON log file used
above to an external database by just changing the
<code>data_storage</code> parameter when initializing
<code>{shiny.telemetr}</code>. To learn how to use the different
available Database backends you can refer to the <a href="https://appsilon.github.io/shiny.telemetry/articles/databases.html">“Use
External Databases with shiny.telemetry” guide</a>.</p>
<p>In this section we will show how to use PostgreSQL, which is one of
the supported databases in a Rhino application. Using any of the others
is similar.</p>
<p>The only necessary modification in the code is to replace the
<code>DataStorageLogFile</code> with <code>DataStoragePostgreSQL</code>
and provide the necessary connection information.</p>
<p>However, we recommend using environment variables to store sensitive
information, such as passwords, and avoid storing them directly in the
code. As such, we will use the <code>config.yml</code> and
<code>.Renviron</code> files to keep this information safe.</p>
<p>The first step is changing the data storage backend in
<code>app/main.R</code> file.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># app/main.R (change the data storage backend)</span></span>
<span><span class="va">telemetry</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Telemetry.html">Telemetry</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  app_name <span class="op">=</span> <span class="st">"rhino_app"</span>,</span>
<span>  data_storage <span class="op">=</span> <span class="va"><a href="../reference/DataStoragePostgreSQL.html">DataStoragePostgreSQL</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    user <span class="op">=</span> <span class="va">config</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="st">"postgres_user"</span><span class="op">)</span>,</span>
<span>    password <span class="op">=</span> <span class="va">config</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="st">"postgres_pass"</span><span class="op">)</span>,</span>
<span>    hostname <span class="op">=</span> <span class="va">config</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="st">"postgres_host"</span><span class="op">)</span>,</span>
<span>    port <span class="op">=</span> <span class="va">config</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="st">"postgres_port"</span><span class="op">)</span>,</span>
<span>    dbname <span class="op">=</span> <span class="va">config</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="st">"postgres_dbname"</span><span class="op">)</span>,</span>
<span>    driver <span class="op">=</span> <span class="st">"RPostgreSQL"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Notice that we are using the <a href="https://rstudio.github.io/config/" class="external-link">config</a> package to read
the secrets from the <code>config.yml</code> file. Therefore the next
step is to import the <a href="https://rstudio.github.io/config/" class="external-link">config</a> package with
<a href="https://klmr.me/box/" class="external-link">box</a> in the <code>app/main.R</code> file.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># app/main.R (top of the file)</span></span>
<span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span></span>
<span>  <span class="va">config</span>, <span class="co"># Adds config package that reads config.yml file at the root of the project</span></span>
<span>  <span class="va">shiny</span><span class="op">[</span></span>
<span>    <span class="va">bootstrapPage</span>, <span class="va">div</span>, <span class="va">moduleServer</span>, <span class="va">NS</span>, <span class="va">renderUI</span>, <span class="va">tags</span>, <span class="va">textInput</span>, <span class="va">uiOutput</span>,</span>
<span>    <span class="va">verbatimTextOutput</span>,</span>
<span>  <span class="op">]</span>,</span>
<span>  <span class="co"># other packaage imports ...</span></span>
<span>  <span class="va">shiny.telemetry</span><span class="op">[</span><span class="va">DataStorageLogFile</span>, <span class="va">Telemetry</span>, <span class="va">use_telemetry</span><span class="op">]</span>,</span>
<span><span class="op">)</span></span></code></pre></div>
<p>The <code>config.yml</code> can be configured to read the secrets for
the environment, as well allowing for different configurations for
different environments. It is safe to commit this file to a repository
as it does not contain any sensitive information itself.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># config.yml</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">default</span><span class="kw">:</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="at">  </span><span class="fu">rhino_log_level</span><span class="kw">:</span><span class="at"> !expr Sys.getenv("RHINO_LOG_LEVEL", "INFO")</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="at">  </span><span class="fu">rhino_log_file</span><span class="kw">:</span><span class="at"> !expr Sys.getenv("RHINO_LOG_FILE", NA)</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="at">  </span><span class="fu">postgres_user</span><span class="kw">:</span><span class="at"> !expr Sys.getenv("POSTGRES_USER", NA)</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="at">  </span><span class="fu">postgres_pass</span><span class="kw">:</span><span class="at"> !expr Sys.getenv("POSTGRES_PASS", NA)</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="at">  </span><span class="fu">postgres_host</span><span class="kw">:</span><span class="at"> !expr Sys.getenv("POSTGRES_HOST", NA)</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="at">  </span><span class="fu">postgres_port</span><span class="kw">:</span><span class="at"> !expr Sys.getenv("POSTGRES_PORT", 5432)</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="at">  </span><span class="fu">postgres_dbname</span><span class="kw">:</span><span class="at"> </span><span class="st">"shiny_telemetry"</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="fu">staging</span><span class="kw">:</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="at">  </span><span class="fu">postgres_dbname</span><span class="kw">:</span><span class="at"> </span><span class="st">"shiny_telemetry_stg"</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="fu">production</span><span class="kw">:</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="at">  </span><span class="fu">postgres_dbname</span><span class="kw">:</span><span class="at"> </span><span class="st">"shiny_telemetry_prd"</span></span></code></pre></div>
<p>The last change is on the <code>.Renviron</code> file that will keep
the secrets safe and avoid storing them directly in the code. As long as
this file is not committed to the repository, the secrets will be
safe.</p>
<p>When deploying an application to POSIT Connect or ShinyProxy, the
secrets can be set as environment variables in the deployment
configuration.</p>
<pre><code># .Renviron
POSTGRES_USER=postgres
POSTGRES_PASS=mysecretpassword
POSTGRES_HOST=127.0.0.1</code></pre>
<p>See the Rhino guide to <a href="https://appsilon.github.io/rhino/articles/how-to/manage-secrets-and-environments.html" class="external-link">“Manage
secrets and environments”</a> for more details on the best practices to
manage secrets and environments.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed with <span class="emoji" data-emoji="heart">❤️</span> by <a href="https://www.appsilon.com" class="external-link">Appsilon</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
